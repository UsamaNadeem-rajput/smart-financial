# Backend API .htaccess for OrangeHost
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /api/
  
  # Handle CORS preflight requests
  RewriteCond %{REQUEST_METHOD} OPTIONS
  RewriteRule ^(.*)$ $1 [R=200,L]
  
  # Route all API requests to server.js (if Node.js is available)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ server.js [L,QSA]
</IfModule>

# Security headers
<IfModule mod_headers.c>
  # CORS headers - update yourdomain.com with your actual domain
  Header always set Access-Control-Allow-Origin "https://yourdomain.com"
  Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
  Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
  Header always set Access-Control-Allow-Credentials "true"
  
  # Security headers
  Header always set X-Content-Type-Options nosniff
  Header always set X-Frame-Options DENY
  Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Prevent access to sensitive files
<Files ~ "^\.">
  Order allow,deny
  Deny from all
</Files>

<Files ~ "\.env$">
  Order allow,deny
  Deny from all
</Files>

<Files ~ "package\.json$">
  Order allow,deny
  Deny from all
</Files>

<Files ~ "node_modules">
  Order allow,deny
  Deny from all
</Files>

# Enable compression for API responses
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
</IfModule>